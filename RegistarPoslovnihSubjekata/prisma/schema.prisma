// RegistarPoslovnihSubjekata â€“ tablice prema API Sudskog registra (raw struktura)
// Lista tablica: Open API / dokumentacija Sudskog registra

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- Tablice prema listi API-ja (38 tablica) ---

model BrisPravniOblici {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_bris_pravni_oblici")
}

model BrisRegistri {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_bris_registri")
}

model Counts {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_counts")
}

model DetaljiSubjekta {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_detalji_subjekta")
}

model Drzave {
  id       BigInt   @id
  sifra    String   @db.VarChar(16)
  naziv    String   @db.VarChar(128)
  oznaka2 String?  @map("oznaka_2") @db.VarChar(4)
  oznaka3 String?  @map("oznaka_3") @db.VarChar(4)
  updatedAt DateTime @updatedAt @map("updated_at")
  @@map("sudreg_drzave")
}

model Jezici {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_jezici")
}

model LastResponse {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_last_response")
}

model LastResponseAudit {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_last_response_audit")
}

model NacionalnaKlasifikacijaDjelatnosti {
  id        BigInt   @id
  sifra     String   @db.VarChar(32)
  puniNaziv String?  @map("puni_naziv") @db.VarChar(512)
  verzija   String?  @db.VarChar(32)
  updatedAt DateTime @updatedAt @map("updated_at")
  @@map("sudreg_nacionalna_klasifikacija_djelatnosti")
}

model Promjene {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_promjene")
}

/// Jedna stavka popisa promjena po snapshotu. Polja prema API /promjene: id, mbs, vrijeme, scn.
model PromjeneStavka {
  snapshotId BigInt    @map("snapshot_id")
  subjektId  BigInt    @map("subjekt_id")  // iz API polja "id"
  mbs        BigInt?   @map("mbs")         // iz API polja "mbs"
  scn        BigInt    @map("scn")
  vrijeme    DateTime? @map("vrijeme")     @db.Timestamptz(6)  // iz API polja "vrijeme" (string)
  createdAt  DateTime  @default(now()) @map("created_at")

  @@id([snapshotId, subjektId])
  @@index([snapshotId])
  @@index([scn])
  @@map("sudreg_promjene_stavke")
}

model Statusi {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_statusi")
}

model Subjekti {
  id             BigInt    @id @default(autoincrement())
  mbs            BigInt?   @map("mbs")
  oib            String?   @db.VarChar(11)
  status         Int?      @default(1)
  inoPodruznica  Int?      @map("ino_podruznica") @default(0)
  postupak       Int?
  datumOsnivanja DateTime? @map("datum_osnivanja") @db.Date
  datumBrisanja  DateTime? @map("datum_brisanja") @db.Date
  snapshotId     BigInt?   @map("snapshot_id")
  updatedAt      DateTime  @updatedAt @map("updated_at")
  @@map("sudreg_subjekti")
}

model DjelatnostiPodruznica {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_djelatnosti_podruznica")
}

model EmailAdrese {
  id         BigInt   @id @default(autoincrement())
  subjektId  BigInt?  @map("subjekt_id")
  redniBroj  Int?     @map("redni_broj")
  adresa     String?  @db.VarChar(256)
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_email_adrese")
}

model EmailAdresePodruznica {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_email_adrese_podruznica")
}

model EvidencijskeDjelatnosti {
  id                              BigInt   @id @default(autoincrement())
  subjektId                       BigInt?  @map("subjekt_id")
  redniBroj                       Int?     @map("redni_broj")
  nacionalnaKlasifikacijaDjelatnostiId BigInt? @map("nacionalna_klasifikacija_djelatnosti_id")
  djelatnostTekst                 String?  @map("djelatnost_tekst") @db.VarChar(4000)
  snapshotId                      BigInt?  @map("snapshot_id")
  updatedAt                       DateTime @updatedAt @map("updated_at")
  @@map("sudreg_evidencijske_djelatnosti")
}

model Gfi {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_gfi")
}

model InozemniRegistri {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_inozemni_registri")
}

model NaziviPodruznica {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_nazivi_podruznica")
}

model ObjavePriopcenja {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_objave_priopcenja")
}

model Postupci {
  id           BigInt   @id @default(autoincrement())
  subjektId    BigInt?  @map("subjekt_id")
  postupak     Int?
  datumStecaja DateTime? @map("datum_stecaja") @db.Date
  snapshotId   BigInt?  @map("snapshot_id")
  updatedAt    DateTime @updatedAt @map("updated_at")
  @@map("sudreg_postupci")
}

model PravniOblici {
  id                    BigInt   @id @default(autoincrement())
  subjektId             BigInt?  @map("subjekt_id")
  vrstaPravnogOblikaId  BigInt?  @map("vrsta_pravnog_oblika_id")
  snapshotId            BigInt?  @map("snapshot_id")
  updatedAt             DateTime @updatedAt @map("updated_at")
  @@map("sudreg_pravni_oblici")
}

model PredmetiPoslovanja {
  id                              BigInt   @id @default(autoincrement())
  subjektId                       BigInt?  @map("subjekt_id")
  redniBroj                       Int?     @map("redni_broj")
  nacionalnaKlasifikacijaDjelatnostiId BigInt? @map("nacionalna_klasifikacija_djelatnosti_id")
  djelatnostTekst                 String?  @map("djelatnost_tekst") @db.VarChar(4000)
  snapshotId                      BigInt?  @map("snapshot_id")
  updatedAt                       DateTime @updatedAt @map("updated_at")
  @@map("sudreg_predmeti_poslovanja")
}

model PreteziteDjelatnosti {
  id                              BigInt   @id @default(autoincrement())
  subjektId                       BigInt?  @map("subjekt_id")
  redniBroj                       Int?     @map("redni_broj")
  nacionalnaKlasifikacijaDjelatnostiId BigInt? @map("nacionalna_klasifikacija_djelatnosti_id")
  djelatnostTekst                 String?  @map("djelatnost_tekst") @db.VarChar(4000)
  snapshotId                      BigInt?  @map("snapshot_id")
  updatedAt                       DateTime @updatedAt @map("updated_at")
  @@map("sudreg_pretezite_djelatnosti")
}

model PrijevodiSkracenihTvrtki {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_prijevodi_skracenih_tvrtki")
}

model PrijevodiTvrtki {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_prijevodi_tvrtki")
}

model Sjedista {
  id                 BigInt   @id @default(autoincrement())
  subjektId          BigInt?  @map("subjekt_id")
  redniBroj          Int?     @default(1) @map("redni_broj")
  drzavaId           BigInt?  @map("drzava_id")
  sifraZupanije      Int?     @map("sifra_zupanije")
  nazivZupanije      String?  @map("naziv_zupanije") @db.VarChar(128)
  sifraOpcine        Int?     @map("sifra_opcine")
  nazivOpcine        String?  @map("naziv_opcine") @db.VarChar(128)
  sifraNaselja       BigInt?  @map("sifra_naselja")
  nazivNaselja       String?  @map("naziv_naselja") @db.VarChar(128)
  naseljeVanSifrarnika String? @map("naselje_van_sifrarnika") @db.VarChar(128)
  sifraUlice         BigInt?  @map("sifra_ulice")
  ulica              String?  @db.VarChar(512)
  kucniBroj          Int?     @map("kucni_broj")
  kucniPodbroj       String?  @map("kucni_podbroj") @db.VarChar(10)
  postanskiBroj      Int?     @map("postanski_broj")
  snapshotId         BigInt?  @map("snapshot_id")
  updatedAt          DateTime @updatedAt @map("updated_at")
  @@map("sudreg_sjedista")
}

model SjedistaPodruznica {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_sjedista_podruznica")
}

model SkraceneTvrtke {
  id         BigInt   @id @default(autoincrement())
  subjektId  BigInt?  @map("subjekt_id")
  ime        String?  @db.VarChar(512)
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_skracene_tvrtke")
}

model SkraceniNaziviPodruznica {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_skraceni_nazivi_podruznica")
}

model TemeljniKapitali {
  id                 BigInt   @id @default(autoincrement())
  subjektId          BigInt?  @map("subjekt_id")
  temeljniKapitalRbr Int?     @map("temeljni_kapital_rbr")
  valutaId           BigInt?  @map("valuta_id")
  iznos              Decimal? @db.Decimal(22, 2)
  snapshotId         BigInt?  @map("snapshot_id")
  updatedAt          DateTime @updatedAt @map("updated_at")
  @@map("sudreg_temeljni_kapitali")
}

model Tvrtke {
  id          BigInt   @id @default(autoincrement())
  subjektId   BigInt?  @map("subjekt_id")
  ime         String?  @db.VarChar(1024)
  naznakaImena String? @map("naznaka_imena") @db.VarChar(512)
  snapshotId  BigInt?  @map("snapshot_id")
  updatedAt   DateTime @updatedAt @map("updated_at")
  @@map("sudreg_tvrtke")
}

model Sudovi {
  id            BigInt   @id
  sifra         String   @db.VarChar(32)
  naziv         String   @db.VarChar(256)
  sifraZupanije Int?     @map("sifra_zupanije")
  nazivZupanije String?  @map("naziv_zupanije") @db.VarChar(128)
  updatedAt     DateTime @updatedAt @map("updated_at")
  @@map("sudreg_sudovi")
}

model SudoviDeleted {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_sudovi_deleted")
}

model Valute {
  id        BigInt   @id
  sifra     String   @db.VarChar(16)
  naziv     String   @db.VarChar(128)
  drzavaId  BigInt?  @map("drzava_id")
  updatedAt DateTime @updatedAt @map("updated_at")
  @@map("sudreg_valute")
}

model VrsteGfiDokumenata {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  @@map("sudreg_vrste_gfi_dokumenata")
}

model VrstePostupaka {
  postupak  Int      @id
  znacenje  String   @db.VarChar(256)
  updatedAt DateTime @updatedAt @map("updated_at")
  @@map("sudreg_vrste_postupaka")
}

model VrstePravnihOblika {
  id        BigInt   @id
  sifra     String   @db.VarChar(16)
  naziv     String   @db.VarChar(256)
  kratica   String?  @db.VarChar(32)
  updatedAt DateTime @updatedAt @map("updated_at")
  @@map("sudreg_vrste_pravnih_oblika")
}

// --- Log poziva proxy API-ja (metoda, parametri, status, trajanje, Sudreg response headers) ---
model SudregProxyLog {
  id                BigInt   @id @default(autoincrement())
  endpoint          String   @db.VarChar(256)
  queryString       String?  @map("query_string") @db.VarChar(2048)
  responseStatus    Int?     @map("response_status")
  durationMs        Int?     @map("duration_ms")
  clientIp          String?  @map("client_ip") @db.VarChar(64)
  userAgent         String?  @map("user_agent") @db.VarChar(512)
  xSnapshotId       BigInt?  @map("x_snapshot_id")
  xTimestamp        String?  @map("x_timestamp") @db.VarChar(64)
  xTotalCount       BigInt?  @map("x_total_count")
  xSecondsElapsed   Decimal? @map("x_seconds_elapsed") @db.Decimal(12, 4)
  xRowsReturned     Int?     @map("x_rows_returned")
  xLogId            BigInt?  @map("x_log_id")
  createdAt         DateTime @default(now()) @map("created_at")
  @@index([endpoint])
  @@index([createdAt])
  @@map("sudreg_proxy_log")
}
