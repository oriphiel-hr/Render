// RegistarPoslovnihSubjekata – tablice prema API Sudskog registra (raw struktura)
// Lista tablica: Open API / dokumentacija Sudskog registra

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- Tablice prema listi API-ja (38 tablica) ---

/// Prema OpenAPI: bris_kod, kratica, naziv, drzava_id, vrsta_pravnog_oblika_id, status.
model BrisPravniOblici {
  snapshotId             BigInt   @map("snapshot_id")
  brisKod                String   @map("bris_kod") @db.VarChar(9)
  kratica                String?  @map("kratica") @db.VarChar(130)
  naziv                  String   @map("naziv") @db.VarChar(1024)
  drzavaId               BigInt   @map("drzava_id")
  vrstaPravnogOblikaId   BigInt?  @map("vrsta_pravnog_oblika_id")
  status                 Int      @map("status")
  createdAt              DateTime @default(now()) @map("created_at")
  modifiedAt             DateTime? @updatedAt @map("modified_at")
  glavaId                BigInt?  @map("glava_id")
  glava                  SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, brisKod])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_bris_pravni_oblici")
}

/// Prema OpenAPI: identifikator, naziv, drzava_id, status.
model BrisRegistri {
  snapshotId   BigInt  @map("snapshot_id")
  identifikator String @map("identifikator") @db.VarChar(15)
  naziv        String  @map("naziv") @db.VarChar(256)
  drzavaId     BigInt  @map("drzava_id")
  status       Int     @map("status")
  createdAt    DateTime @default(now()) @map("created_at")
  modifiedAt   DateTime? @updatedAt @map("modified_at")
  glavaId      BigInt?  @map("glava_id")
  glava        SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, identifikator])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_bris_registri")
}

/// Prema OpenAPI: table_name, count_aktivni.
model Counts {
  snapshotId   BigInt  @map("snapshot_id")
  tableName    String  @map("table_name") @db.VarChar(128)
  countAktivni BigInt  @map("count_aktivni")
  createdAt    DateTime @default(now()) @map("created_at")
  modifiedAt   DateTime? @updatedAt @map("modified_at")
  glavaId      BigInt?  @map("glava_id")
  glava        SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, tableName])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_counts")
}

model DetaljiSubjekta {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  glavaId    BigInt?  @map("glava_id")
  glava      SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_detalji_subjekta")
}

model Drzave {
  id       BigInt   @id
  sifra    String   @db.VarChar(16)
  naziv    String   @db.VarChar(128)
  oznaka2 String?  @map("oznaka_2") @db.VarChar(4)
  oznaka3 String?  @map("oznaka_3") @db.VarChar(4)
  updatedAt DateTime @updatedAt @map("updated_at")
  glavaId  BigInt?  @map("glava_id")
  glava    SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_drzave")
}

model Jezici {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  glavaId    BigInt?  @map("glava_id")
  glava      SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_jezici")
}

model NacionalnaKlasifikacijaDjelatnosti {
  id        BigInt   @id
  sifra     String   @db.VarChar(32)
  puniNaziv String?  @map("puni_naziv") @db.VarChar(512)
  verzija   String?  @db.VarChar(32)
  updatedAt DateTime @updatedAt @map("updated_at")
  glavaId   BigInt?  @map("glava_id")
  glava     SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_nacionalna_klasifikacija_djelatnosti")
}

/// Generička glava za sync po snapshotu i tipu entiteta (subjekti, promjene, …). Jedan red = jedan snapshot + jedan tip.
/// Za chunked sync (npr. promjene): next_offset_to_fetch = sljedeći offset (null = gotovo ili nije pokrenuto).
model SudregSyncGlava {
  id                 BigInt    @id @default(autoincrement()) @map("rps_sudreg_sync_glava_id")
  snapshotId         BigInt    @map("snapshot_id")
  tipEntiteta        String    @map("tip_entiteta") @db.VarChar(64)  // subjekti | promjene | ...
  status             String    @default("u_tijeku") @map("status") @db.VarChar(32)  // u_tijeku | ok | greska
  expectedCount      BigInt?   @map("expected_count")
  actualCount        BigInt?   @map("actual_count")
  nextOffsetToFetch  BigInt?   @map("next_offset_to_fetch")
  vrijemePocetka     DateTime? @map("vrijeme_pocetka") @db.Timestamptz(6)
  vrijemeZavrsetka   DateTime? @map("vrijeme_zavrsetka") @db.Timestamptz(6)
  greska             String?   @map("greska") @db.Text
  createdAt          DateTime  @default(now()) @map("created_at")
  updatedAt          DateTime  @updatedAt @map("updated_at")

  brisPravniOblici   BrisPravniOblici[]
  brisRegistri       BrisRegistri[]
  counts             Counts[]
  detaljiSubjekta    DetaljiSubjekta[]
  djelatnostiPodruznica DjelatnostiPodruznica[]
  drzave             Drzave[]
  emailAdrese        EmailAdrese[]
  emailAdresePodruznica EmailAdresePodruznica[]
  evidencijskeDjelatnosti EvidencijskeDjelatnosti[]
  gfi                Gfi[]
  inozemniRegistri   InozemniRegistri[]
  jezici             Jezici[]
  nacionalnaKlasifikacijaDjelatnosti NacionalnaKlasifikacijaDjelatnosti[]
  naziviPodruznica   NaziviPodruznica[]
  objavePriopcenja   ObjavePriopcenja[]
  postupci           Postupci[]
  pravniOblici       PravniOblici[]
  predmetiPoslovanja PredmetiPoslovanja[]
  preteziteDjelatnosti PreteziteDjelatnosti[]
  prijevodiSkracenihTvrtki PrijevodiSkracenihTvrtki[]
  prijevodiTvrtki    PrijevodiTvrtki[]
  sjedista           Sjedista[]
  sjedistaPodruznica  SjedistaPodruznica[]
  skraceneTvrtke      SkraceneTvrtke[]
  skraceniNaziviPodruznica SkraceniNaziviPodruznica[]
  statusi             Statusi[]
  subjekti           Subjekti[]
  sudovi             Sudovi[]
  sudoviDeleted      SudoviDeleted[]
  temeljniKapitali   TemeljniKapitali[]
  tvrtke             Tvrtke[]
  valute             Valute[]
  vrsteGfiDokumenata VrsteGfiDokumenata[]
  vrstePostupaka     VrstePostupaka[]
  vrstePravnihOblika VrstePravnihOblika[]

  @@unique([snapshotId, tipEntiteta])
  @@index([snapshotId])
  @@map("rps_sudreg_sync_glava")
}

model Statusi {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  glavaId    BigInt?  @map("glava_id")
  glava      SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_statusi")
}

/// Prema OpenAPI: subjekti (mbs, status, sud_id_nadlezan, sud_id_sluzba, postupak, oib, mb, ino_podruznica, stecajna_masa, likvidacijska_masa, …).
model Subjekti {
  id                   BigInt    @id @default(autoincrement())
  mbs                  BigInt?   @map("mbs")
  oib                  String?   @db.VarChar(11)
  status               Int?      @default(1)
  inoPodruznica        Int?      @map("ino_podruznica") @default(0)
  postupak             Int?
  datumOsnivanja       DateTime? @map("datum_osnivanja") @db.Date
  datumBrisanja        DateTime? @map("datum_brisanja") @db.Date
  sudIdNadlezan        BigInt?   @map("sud_id_nadlezan")
  sudIdSluzba          BigInt?   @map("sud_id_sluzba")
  mb                   Int?      @map("mb")
  stecajnaMasa         Int?      @map("stecajna_masa")
  likvidacijskaMasa     Int?      @map("likvidacijska_masa")
  mbsBrisanogSubjekta  BigInt?   @map("mbs_brisanog_subjekta")
  glavnaDjelatnost     Int?      @map("glavna_djelatnost")
  glavnaPodruznicaRbr  Int?      @map("glavna_podruznica_rbr")
  sudIdBrisanja        BigInt?   @map("sud_id_brisanja")
  tvrtkaKodBrisanja    String?   @map("tvrtka_kod_brisanja") @db.VarChar(1024)
  poslovniBrojBrisanja String?   @map("poslovni_broj_brisanja") @db.VarChar(17)
  snapshotId           BigInt?   @map("snapshot_id")
  updatedAt            DateTime  @updatedAt @map("updated_at")
  glavaId              BigInt?   @map("glava_id")
  redniBrojUSetu       BigInt?   @map("redni_broj_u_setu")
  glava                SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_subjekti")
}

/// Prema OpenAPI: mbs, podruznica_rbr, djelatnost_rbr, nacionalna_klasifikacija_djelatnosti_id, djelatnost_tekst.
model DjelatnostiPodruznica {
  snapshotId     BigInt    @map("snapshot_id")
  mbs            BigInt    @map("mbs")
  podruznicaRbr  Int       @map("podruznica_rbr")
  djelatnostRbr  Int       @map("djelatnost_rbr")
  nacionalnaKlasifikacijaDjelatnostiId BigInt? @map("nacionalna_klasifikacija_djelatnosti_id")
  djelatnostTekst String?  @map("djelatnost_tekst") @db.VarChar(4000)
  createdAt      DateTime  @default(now()) @map("created_at")
  modifiedAt     DateTime? @updatedAt @map("modified_at")
  glavaId        BigInt?   @map("glava_id")
  glava          SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, podruznicaRbr, djelatnostRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_djelatnosti_podruznica")
}

/// Prema OpenAPI: mbs, email_adresa_rbr, adresa.
model EmailAdrese {
  id            BigInt   @id @default(autoincrement())
  mbo           BigInt?  @map("mbo")
  emailAdresaRbr Int?    @map("email_adresa_rbr")
  adresa        String?  @db.VarChar(256)
  snapshotId    BigInt?  @map("snapshot_id")
  updatedAt     DateTime @updatedAt @map("updated_at")
  glavaId       BigInt?  @map("glava_id")
  redniBrojUSetu BigInt? @map("redni_broj_u_setu")
  glava         SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_email_adrese")
}

/// Prema OpenAPI: mbs, podruznica_rbr, email_adresa_rbr, adresa.
model EmailAdresePodruznica {
  snapshotId     BigInt  @map("snapshot_id")
  mbs           BigInt  @map("mbs")
  podruznicaRbr Int     @map("podruznica_rbr")
  emailAdresaRbr Int    @map("email_adresa_rbr")
  adresa        String  @map("adresa") @db.VarChar(256)
  createdAt     DateTime @default(now()) @map("created_at")
  modifiedAt    DateTime? @updatedAt @map("modified_at")
  glavaId       BigInt?  @map("glava_id")
  glava         SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, podruznicaRbr, emailAdresaRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_email_adrese_podruznica")
}

model EvidencijskeDjelatnosti {
  id                              BigInt   @id @default(autoincrement())
  mbo                             BigInt?  @map("mbo")
  redniBroj                       Int?     @map("redni_broj")
  nacionalnaKlasifikacijaDjelatnostiId BigInt? @map("nacionalna_klasifikacija_djelatnosti_id")
  djelatnostTekst                 String?  @map("djelatnost_tekst") @db.VarChar(4000)
  snapshotId                      BigInt?  @map("snapshot_id")
  updatedAt                       DateTime @updatedAt @map("updated_at")
  glavaId                         BigInt?  @map("glava_id")
  redniBrojUSetu                  BigInt?  @map("redni_broj_u_setu")
  glava                           SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_evidencijske_djelatnosti")
}

/// Prema OpenAPI: mbs, gfi_rbr, vrsta_dokumenta, oznaka_konsolidacije, godina_izvjestaja, datum_dostave, datum_od, datum_do.
model Gfi {
  snapshotId           BigInt    @map("snapshot_id")
  mbs                  BigInt    @map("mbs")
  gfiRbr               BigInt    @map("gfi_rbr")
  vrstaDokumenta       Int       @map("vrsta_dokumenta")
  oznakaKonsolidacije   Int       @map("oznaka_konsolidacije")
  godinaIzvjestaja      Int       @map("godina_izvjestaja")
  datumDostave          DateTime  @map("datum_dostave") @db.Date
  datumOd               DateTime  @map("datum_od") @db.Date
  datumDo               DateTime  @map("datum_do") @db.Date
  createdAt            DateTime  @default(now()) @map("created_at")
  modifiedAt            DateTime? @updatedAt @map("modified_at")
  glavaId              BigInt?   @map("glava_id")
  glava                SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, gfiRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_gfi")
}

/// Prema OpenAPI: mbs, drzava_id, naziv_registra, registarsko_tijelo, broj_iz_registra, pravni_oblik, bris_registar_identifikator, euid, bris_pravni_oblik_kod.
model InozemniRegistri {
  snapshotId              BigInt   @map("snapshot_id")
  mbs                     BigInt   @map("mbs")
  drzavaId                BigInt   @map("drzava_id")
  nazivRegistra           String?  @map("naziv_registra") @db.VarChar(128)
  registarskoTijelo       String?  @map("registarsko_tijelo") @db.VarChar(128)
  brojIzRegistra          String?  @map("broj_iz_registra") @db.VarChar(128)
  pravniOblik             String?  @map("pravni_oblik") @db.VarChar(200)
  brisRegistarIdentifikator String? @map("bris_registar_identifikator") @db.VarChar(15)
  euid                    String?  @map("euid") @db.VarChar(54)
  brisPravniOblikKod      String?  @map("bris_pravni_oblik_kod") @db.VarChar(9)
  createdAt               DateTime @default(now()) @map("created_at")
  modifiedAt              DateTime? @updatedAt @map("modified_at")
  glavaId                 BigInt?  @map("glava_id")
  glava                   SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, drzavaId])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_inozemni_registri")
}

/// Prema OpenAPI: mbs, podruznica_rbr, ime, naznaka_imena, postupak, glavna_podruznica.
model NaziviPodruznica {
  snapshotId     BigInt   @map("snapshot_id")
  mbs            BigInt   @map("mbs")
  podruznicaRbr  Int      @map("podruznica_rbr")
  ime            String   @map("ime") @db.VarChar(1024)
  naznakaImena   String?  @map("naznaka_imena") @db.VarChar(128)
  postupak       Int      @map("postupak")
  glavnaPodruznica Int    @map("glavna_podruznica")
  createdAt      DateTime @default(now()) @map("created_at")
  modifiedAt     DateTime? @updatedAt @map("modified_at")
  glavaId        BigInt?  @map("glava_id")
  glava          SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, podruznicaRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_nazivi_podruznica")
}

/// Prema OpenAPI: mbs, tekst.
model ObjavePriopcenja {
  snapshotId BigInt   @map("snapshot_id")
  mbs        BigInt   @map("mbs")
  tekst      String   @map("tekst") @db.VarChar(2000)
  createdAt  DateTime @default(now()) @map("created_at")
  modifiedAt DateTime? @updatedAt @map("modified_at")
  glavaId    BigInt?  @map("glava_id")
  glava      SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, tekst])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_objave_priopcenja")
}

model Postupci {
  id           BigInt   @id @default(autoincrement())
  mbo          BigInt?  @map("mbo")
  postupak     Int?
  datumStecaja DateTime? @map("datum_stecaja") @db.Date
  snapshotId   BigInt?  @map("snapshot_id")
  updatedAt    DateTime @updatedAt @map("updated_at")
  glavaId      BigInt?  @map("glava_id")
  redniBrojUSetu BigInt? @map("redni_broj_u_setu")
  glava        SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_postupci")
}

model PravniOblici {
  id                    BigInt   @id @default(autoincrement())
  mbo                   BigInt?  @map("mbo")
  vrstaPravnogOblikaId  BigInt?  @map("vrsta_pravnog_oblika_id")
  snapshotId            BigInt?  @map("snapshot_id")
  updatedAt             DateTime @updatedAt @map("updated_at")
  glavaId               BigInt?  @map("glava_id")
  redniBrojUSetu        BigInt?  @map("redni_broj_u_setu")
  glava                 SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_pravni_oblici")
}

model PredmetiPoslovanja {
  id                              BigInt   @id @default(autoincrement())
  mbo                             BigInt?  @map("mbo")
  redniBroj                       Int?     @map("redni_broj")
  nacionalnaKlasifikacijaDjelatnostiId BigInt? @map("nacionalna_klasifikacija_djelatnosti_id")
  djelatnostTekst                 String?  @map("djelatnost_tekst") @db.VarChar(4000)
  snapshotId                      BigInt?  @map("snapshot_id")
  updatedAt                       DateTime @updatedAt @map("updated_at")
  glavaId                         BigInt?  @map("glava_id")
  redniBrojUSetu                  BigInt?  @map("redni_broj_u_setu")
  glava                           SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_predmeti_poslovanja")
}

model PreteziteDjelatnosti {
  id                              BigInt   @id @default(autoincrement())
  mbo                             BigInt?  @map("mbo")
  redniBroj                       Int?     @map("redni_broj")
  nacionalnaKlasifikacijaDjelatnostiId BigInt? @map("nacionalna_klasifikacija_djelatnosti_id")
  djelatnostTekst                 String?  @map("djelatnost_tekst") @db.VarChar(4000)
  snapshotId                      BigInt?  @map("snapshot_id")
  updatedAt                       DateTime @updatedAt @map("updated_at")
  glavaId                         BigInt?  @map("glava_id")
  redniBrojUSetu                  BigInt?  @map("redni_broj_u_setu")
  glava                           SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_pretezite_djelatnosti")
}

/// Prema OpenAPI: mbs, prijevod_skracene_tvrtke_rbr, ime, jezik_id.
model PrijevodiSkracenihTvrtki {
  snapshotId                BigInt  @map("snapshot_id")
  mbs                       BigInt  @map("mbs")
  prijevodSkraceneTvrtkeRbr Int     @map("prijevod_skracene_tvrtke_rbr")
  ime                       String  @map("ime") @db.VarChar(512)
  jezikId                   BigInt  @map("jezik_id")
  createdAt                 DateTime @default(now()) @map("created_at")
  modifiedAt                DateTime? @updatedAt @map("modified_at")
  glavaId                   BigInt?  @map("glava_id")
  glava                     SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, prijevodSkraceneTvrtkeRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_prijevodi_skracenih_tvrtki")
}

/// Prema OpenAPI: mbs, prijevod_tvrtke_rbr, ime, jezik_id.
model PrijevodiTvrtki {
  snapshotId        BigInt   @map("snapshot_id")
  mbs               BigInt   @map("mbs")
  prijevodTvrtkeRbr Int      @map("prijevod_tvrtke_rbr")
  ime               String   @map("ime") @db.VarChar(1024)
  jezikId           BigInt   @map("jezik_id")
  createdAt         DateTime @default(now()) @map("created_at")
  modifiedAt        DateTime? @updatedAt @map("modified_at")
  glavaId           BigInt?  @map("glava_id")
  glava             SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, prijevodTvrtkeRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_prijevodi_tvrtki")
}

model Sjedista {
  id                 BigInt   @id @default(autoincrement())
  mbo                BigInt?  @map("mbo")
  redniBroj          Int?     @default(1) @map("redni_broj")
  drzavaId           BigInt?  @map("drzava_id")
  sifraZupanije      Int?     @map("sifra_zupanije")
  nazivZupanije      String?  @map("naziv_zupanije") @db.VarChar(128)
  sifraOpcine        Int?     @map("sifra_opcine")
  nazivOpcine        String?  @map("naziv_opcine") @db.VarChar(128)
  sifraNaselja       BigInt?  @map("sifra_naselja")
  nazivNaselja       String?  @map("naziv_naselja") @db.VarChar(128)
  naseljeVanSifrarnika String? @map("naselje_van_sifrarnika") @db.VarChar(128)
  sifraUlice         BigInt?  @map("sifra_ulice")
  ulica              String?  @db.VarChar(512)
  kucniBroj          Int?     @map("kucni_broj")
  kucniPodbroj       String?  @map("kucni_podbroj") @db.VarChar(10)
  postanskiBroj      Int?     @map("postanski_broj")
  snapshotId         BigInt?  @map("snapshot_id")
  updatedAt          DateTime @updatedAt @map("updated_at")
  glavaId            BigInt?  @map("glava_id")
  redniBrojUSetu     BigInt?  @map("redni_broj_u_setu")
  glava              SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_sjedista")
}

/// Prema OpenAPI: mbs, podruznica_rbr, sifra_zupanije, naziv_zupanije, sifra_opcine, naziv_opcine, sifra_naselja, naziv_naselja, sifra_ulice, ulica, kucni_broj, kucni_podbroj.
model SjedistaPodruznica {
  snapshotId    BigInt   @map("snapshot_id")
  mbs           BigInt   @map("mbs")
  podruznicaRbr Int      @map("podruznica_rbr")
  sifraZupanije Int      @map("sifra_zupanije")
  nazivZupanije String   @map("naziv_zupanije") @db.VarChar(128)
  sifraOpcine   Int      @map("sifra_opcine")
  nazivOpcine   String   @map("naziv_opcine") @db.VarChar(128)
  sifraNaselja  BigInt   @map("sifra_naselja")
  nazivNaselja  String   @map("naziv_naselja") @db.VarChar(128)
  sifraUlice    BigInt?  @map("sifra_ulice")
  ulica         String?  @db.VarChar(512)
  kucniBroj     Int?     @map("kucni_broj")
  kucniPodbroj  String?  @map("kucni_podbroj") @db.VarChar(10)
  createdAt     DateTime @default(now()) @map("created_at")
  modifiedAt    DateTime? @updatedAt @map("modified_at")
  glavaId       BigInt?  @map("glava_id")
  glava         SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, podruznicaRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_sjedista_podruznica")
}

model SkraceneTvrtke {
  id         BigInt   @id @default(autoincrement())
  mbo        BigInt?  @map("mbo")
  ime        String?  @db.VarChar(512)
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  glavaId    BigInt?  @map("glava_id")
  redniBrojUSetu BigInt? @map("redni_broj_u_setu")
  glava      SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_skracene_tvrtke")
}

/// Prema OpenAPI: mbs, podruznica_rbr, ime.
model SkraceniNaziviPodruznica {
  snapshotId    BigInt   @map("snapshot_id")
  mbs           BigInt   @map("mbs")
  podruznicaRbr Int      @map("podruznica_rbr")
  ime           String   @map("ime") @db.VarChar(512)
  createdAt     DateTime @default(now()) @map("created_at")
  modifiedAt    DateTime? @updatedAt @map("modified_at")
  glavaId       BigInt?  @map("glava_id")
  glava         SudregSyncGlava? @relation(fields: [glavaId], references: [id])

  @@id([snapshotId, mbs, podruznicaRbr])
  @@index([snapshotId])
  @@index([glavaId])
  @@map("sudreg_entitet_skraceni_nazivi_podruznica")
}

model TemeljniKapitali {
  id                 BigInt   @id @default(autoincrement())
  mbo                BigInt?  @map("mbo")
  temeljniKapitalRbr Int?     @map("temeljni_kapital_rbr")
  valutaId           BigInt?  @map("valuta_id")
  iznos              Decimal? @db.Decimal(22, 2)
  snapshotId         BigInt?  @map("snapshot_id")
  updatedAt          DateTime @updatedAt @map("updated_at")
  glavaId            BigInt?  @map("glava_id")
  redniBrojUSetu     BigInt?  @map("redni_broj_u_setu")
  glava              SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_temeljni_kapitali")
}

model Tvrtke {
  id          BigInt   @id @default(autoincrement())
  mbo         BigInt?  @map("mbo")
  ime         String?  @db.VarChar(1024)
  naznakaImena String? @map("naznaka_imena") @db.VarChar(512)
  snapshotId  BigInt?  @map("snapshot_id")
  updatedAt   DateTime @updatedAt @map("updated_at")
  glavaId     BigInt?  @map("glava_id")
  redniBrojUSetu BigInt? @map("redni_broj_u_setu")
  glava       SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_entitet_tvrtke")
}

model Sudovi {
  id            BigInt   @id
  sifra         String   @db.VarChar(32)
  naziv         String   @db.VarChar(256)
  sifraZupanije Int?     @map("sifra_zupanije")
  nazivZupanije String?  @map("naziv_zupanije") @db.VarChar(128)
  updatedAt     DateTime @updatedAt @map("updated_at")
  glavaId       BigInt?  @map("glava_id")
  glava         SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_sudovi")
}

model SudoviDeleted {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  glavaId    BigInt?  @map("glava_id")
  glava      SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_sudovi_deleted")
}

model Valute {
  id        BigInt   @id
  sifra     String   @db.VarChar(16)
  naziv     String   @db.VarChar(128)
  drzavaId  BigInt?  @map("drzava_id")
  updatedAt DateTime @updatedAt @map("updated_at")
  glavaId   BigInt?  @map("glava_id")
  glava     SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_valute")
}

model VrsteGfiDokumenata {
  id         BigInt   @id @default(autoincrement())
  snapshotId BigInt?  @map("snapshot_id")
  updatedAt  DateTime @updatedAt @map("updated_at")
  glavaId    BigInt?  @map("glava_id")
  glava      SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_vrste_gfi_dokumenata")
}

model VrstePostupaka {
  postupak  Int      @id
  znacenje  String   @db.VarChar(256)
  updatedAt DateTime @updatedAt @map("updated_at")
  glavaId   BigInt?  @map("glava_id")
  glava     SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_vrste_postupaka")
}

model VrstePravnihOblika {
  id        BigInt   @id
  sifra     String   @db.VarChar(16)
  naziv     String   @db.VarChar(256)
  kratica   String?  @db.VarChar(32)
  updatedAt DateTime @updatedAt @map("updated_at")
  glavaId   BigInt?  @map("glava_id")
  glava     SudregSyncGlava? @relation(fields: [glavaId], references: [id])
  @@index([glavaId])
  @@map("sudreg_sifrarnik_vrste_pravnih_oblika")
}

// --- Log svih dolaznih API poziva (method, path, status, trajanje; response skraćen) ---
model ApiRequestLog {
  id             BigInt   @id @default(autoincrement())
  method         String   @db.VarChar(16)
  path           String   @db.VarChar(512)
  queryString    String?  @map("query_string") @db.VarChar(2048)
  statusCode     Int      @map("status_code")
  durationMs     Int      @map("duration_ms")
  clientIp       String?  @map("client_ip") @db.VarChar(64)
  userAgent      String?  @map("user_agent") @db.VarChar(512)
  responsePreview String? @map("response_preview") @db.VarChar(1024)
  createdAt      DateTime @default(now()) @map("created_at")
  modifiedAt     DateTime? @updatedAt @map("modified_at")
  @@index([path])
  @@index([createdAt])
  @@map("rps_sudreg_api_request_log")
}

/// Očekivani broj redova po endpointu + snapshot (iz X-Total-Count; dohvat s offset=0&limit=0).
model SudregExpectedCount {
  endpoint   String   @db.VarChar(64)
  snapshotId BigInt   @map("snapshot_id")
  totalCount BigInt   @map("total_count")
  createdAt  DateTime @default(now()) @map("created_at")
  modifiedAt DateTime? @updatedAt @map("modified_at")

  @@id([endpoint, snapshotId])
  @@index([snapshotId])
  @@map("rps_sudreg_expected_counts")
}

/// Promjene nad subjektima (mbs, id, vrijeme, scn) za zadani snapshot_id – iz Sudreg /promjene endpointa.
model SudregPromjene {
  snapshotId BigInt   @map("snapshot_id")
  mbs        BigInt   @map("mbs")
  promjenaId BigInt   @map("id")
  vrijeme    DateTime @map("vrijeme")
  scn        BigInt   @map("scn")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")

  @@id([snapshotId, mbs, promjenaId])
  @@index([snapshotId])
  @@index([mbs])
  @@map("sudreg_promjene")
}

/// Audit: što se promijenilo kod UPDATE-a (stupac, stara/nova vrijednost). Punjeni iz DB triggera. snapshot_id iz retka ako postoji; izvor = tko/što je napravio promjenu (iz session app.audit_context).
model SudregAuditPromjene {
  id              BigInt   @id @default(autoincrement()) @map("rps_sudreg_audit_promjene_id")
  tablica         String   @db.VarChar(128)
  redKljuc        String?  @map("red_kljuc") @db.VarChar(1024)
  stupac          String   @db.VarChar(128)
  staraVrijednost String?  @map("stara_vrijednost") @db.Text
  novaVrijednost  String?  @map("nova_vrijednost") @db.Text
  changedAt       DateTime @default(now()) @map("changed_at")
  snapshotId      BigInt?  @map("snapshot_id")
  izvor           String?  @db.VarChar(256)

  @@index([tablica])
  @@index([changedAt])
  @@index([snapshotId])
  @@index([izvor])
  @@map("rps_sudreg_audit_promjene")
}
